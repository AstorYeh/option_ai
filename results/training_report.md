# 台指期選擇權 - 自我學習訓練報告

**生成時間**: 2026-02-14 21:54:27  
**策略評級**: **A+**  
**測試集評分**: 0.9405

---

## [DATA] 資料統計

### 資料分割
- **總資料筆數**: 9704
- **訓練集**: 7763 筆 (80.0%)
  - 日期範圍: 2023-02-15 00:00:00 ~ 2025-07-25 00:00:00
- **測試集**: 1941 筆 (20.0%)
  - 日期範圍: 2025-07-25 00:00:00 ~ 2026-02-11 00:00:00

### 特徵工程
- **特徵數量**: 60
- **特徵類型**: 技術指標 + 價格衍生特徵 (排除原始 OHLCV)
- **已排除**: open, high, low, close, volume, spread, spread_per, atr

---

## [MODEL] 模型訓練

### 方向性預測模型
- **模型類型**: XGBClassifier + Stacking Ensemble
- **交叉驗證**: TimeSeriesSplit (5 折)
- **訓練時間**: 2026-02-14 21:53:13
- **訓練樣本**: 7763 筆

### 過擬合三方對比

| 指標 | 訓練集 | 交叉驗證 | 測試集 |
|------|--------|----------|--------|
| 準確率/評分 | 69.10% | 62.04% | 0.9405 |

- **過擬合差距 (訓練-CV)**: 7.06%
- **結論**: OK 泛化良好

### 最佳超參數
```json
{
  "subsample": 0.8,
  "reg_lambda": 1.0,
  "reg_alpha": 0.1,
  "n_estimators": 100,
  "min_child_weight": 7,
  "max_depth": 5,
  "learning_rate": 0.01,
  "gamma": 0.1,
  "colsample_bytree": 0.8
}
```

### Top 10 重要特徵
1. **williams_r**: 0.1668
2. **price_position**: 0.1157
3. **ma20_dev**: 0.0518
4. **roc_5**: 0.0424
5. **ma60_dev**: 0.0269
6. **bb_position**: 0.0240
7. **top5_avg_return**: 0.0219
8. **inst_total_net_oi**: 0.0195
9. **ma5_dev**: 0.0191
10. **historical_volatility**: 0.0183

[OK] 無原始價格洩漏

---

## [OPT] 策略優化

### 選擇權真實成本參數
- **Delta (ATM)**: 0.5 (價平選擇權)
- **Theta 每日衰減**: 0.3%
- **滑價**: 10 點/次
- **最低交易門檻**: 20 筆

### 最佳參數
- **持有期間**: 5 天
- **信心度閾值**: 0.65
- **停損點**: 2.0%
- **停利點**: 20.0%

### 訓練集回測績效 (含真實成本)
- **總交易次數**: 333
- **勝率**: 90.99%
- **平均報酬率**: 17.99%
- **Sharpe Ratio**: 2.8459
- **Calmar Ratio**: 4.5427
- **最大回撤**: 3.96%
- **Profit Factor**: 100.8401

---

## [TEST] 測試集驗證

### Out-of-Sample 績效 (含真實成本)
- **總交易次數**: 155
- **勝率**: 87.10%
- **平均報酬率**: 17.13%
- **Sharpe Ratio**: 2.3149
- **Calmar Ratio**: 4.3248
- **最大回撤**: 3.96%
- **Profit Factor**: 67.3643

### 訓練集 vs 測試集比較

| 指標 | 訓練集 | 測試集 | 差異 |
|------|--------|--------|------|
| 勝率 | 90.99% | 87.10% | -3.89% |
| 平均報酬 | 17.99% | 17.13% | -0.86% |
| Sharpe | 2.8459 | 2.3149 | -0.5310 |
| 評分 | 0.9670 | 0.9405 | -0.0265 |

### 過擬合分析
- **評分差異**: 0.0265
- **結論**: OK 泛化良好

---

## [TRADES] 交易分析

### 訓練集交易
- **總交易**: 333 筆
- **Buy Call**: 333 筆
- **Buy Put**: 0 筆

### 測試集交易
- **總交易**: 155 筆
- **Buy Call**: 155 筆
- **Buy Put**: 0 筆

---

## [GRADE] 策略評級

### 評級標準
- **A+ (>=0.9)**: 優秀, 可考慮實盤
- **A (>=0.8)**: 良好, 謹慎實盤
- **B (>=0.7)**: 中等, 需優化
- **C (>=0.6)**: 不佳, 需大幅改進
- **D (>=0.4)**: 差, 重新設計
- **F (<0.4)**: 失敗, 根本性問題

### 本次評級: **A+**

**綜合評分**: 0.9405

### 建議
[OK] 策略表現優秀:
1. 進行 1-2 個月紙上交易驗證
2. 小額實盤測試
3. 持續監控績效
4. 定期重新訓練模型

---

## [!] 風險提示

1. **資料不足**: 目前僅 9704 筆資料, 建議累積至 200+ 筆
2. **市場變化**: 歷史績效不代表未來表現
3. **選擇權風險**: 買方策略可能損失全部權利金
4. **模型限制**: 機器學習模型無法預測極端事件
5. **真實成本**: 報告已包含 Delta/Theta/滑價模擬, 實際成本可能更高

---

## [FILES] 輸出檔案

- `data/train/` - 訓練集資料
- `data/test/` - 測試集資料
- `models/direction_model.pkl` - XGBoost 模型
- `models/lgbm_model.pkl` - LightGBM 模型 (若有)
- `models/meta_learner.pkl` - Stacking Meta Learner (若有)
- `models/feature_cols.json` - 特徵欄位列表
- `results/optimization.json` - 最佳參數
- `results/backtest_train.csv` - 訓練集交易記錄
- `results/backtest_test.csv` - 測試集交易記錄
- `results/training_report.md` - 本報告

---

**報告結束**
