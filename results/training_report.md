# 台指期選擇權 - 自我學習訓練報告

**生成時間**: 2026-02-14 21:00:28  
**策略評級**: **D**  
**測試集評分**: 0.5982

---

## [DATA] 資料統計

### 資料分割
- **總資料筆數**: 947
- **訓練集**: 757 筆 (79.9%)
  - 日期範圍: 2025-11-17 00:00:00 ~ 2026-01-27 00:00:00
- **測試集**: 190 筆 (20.1%)
  - 日期範圍: 2026-01-27 00:00:00 ~ 2026-02-11 00:00:00

### 特徵工程
- **特徵數量**: 30
- **特徵類型**: 技術指標 + 價格衍生特徵 (排除原始 OHLCV)
- **已排除**: open, high, low, close, volume, spread, spread_per, atr

---

## [MODEL] 模型訓練

### 方向性預測模型
- **模型類型**: XGBClassifier + Stacking Ensemble
- **交叉驗證**: TimeSeriesSplit (5 折)
- **訓練時間**: 2026-02-14 20:59:52
- **訓練樣本**: 757 筆

### 過擬合三方對比

| 指標 | 訓練集 | 交叉驗證 | 測試集 |
|------|--------|----------|--------|
| 準確率/評分 | 68.16% | 62.54% | 0.5982 |

- **過擬合差距 (訓練-CV)**: 5.62%
- **結論**: OK 泛化良好

### 最佳超參數
```json
{
  "subsample": 0.7,
  "reg_lambda": 5.0,
  "reg_alpha": 5.0,
  "n_estimators": 100,
  "min_child_weight": 7,
  "max_depth": 4,
  "learning_rate": 0.01,
  "gamma": 0,
  "colsample_bytree": 0.8
}
```

### Top 10 重要特徵
1. **ma20_dev**: 0.2258
2. **williams_r**: 0.2166
3. **price_position**: 0.1458
4. **atr_pct**: 0.0761
5. **macd_histogram_pct**: 0.0507
6. **ma5_dev**: 0.0306
7. **rsi**: 0.0228
8. **macd_pct**: 0.0191
9. **bb_position**: 0.0184
10. **roc_10**: 0.0175

[OK] 無原始價格洩漏

---

## [OPT] 策略優化

### 選擇權真實成本參數
- **Delta (ATM)**: 0.5 (價平選擇權)
- **Theta 每日衰減**: 0.3%
- **滑價**: 10 點/次
- **最低交易門檻**: 20 筆

### 最佳參數
- **持有期間**: 5 天
- **信心度閾值**: 0.60
- **停損點**: 3.0%
- **停利點**: 20.0%

### 訓練集回測績效 (含真實成本)
- **總交易次數**: 61
- **勝率**: 96.72%
- **平均報酬率**: 19.25%
- **Sharpe Ratio**: 4.6603
- **Calmar Ratio**: 6.4153
- **最大回撤**: 3.00%
- **Profit Factor**: 196.6667

---

## [TEST] 測試集驗證

### Out-of-Sample 績效 (含真實成本)
- **總交易次數**: 15
- **勝率**: 80.00%
- **平均報酬率**: 15.53%
- **Sharpe Ratio**: 1.6758
- **Calmar Ratio**: 5.1762
- **最大回撤**: 3.00%
- **Profit Factor**: 33.9335

### 訓練集 vs 測試集比較

| 指標 | 訓練集 | 測試集 | 差異 |
|------|--------|--------|------|
| 勝率 | 96.72% | 80.00% | -16.72% |
| 平均報酬 | 19.25% | 15.53% | -3.72% |
| Sharpe | 4.6603 | 1.6758 | -2.9845 |
| 評分 | 0.9873 | 0.5982 | -0.3891 |

### 過擬合分析
- **評分差異**: 0.3891
- **結論**: !! 嚴重過擬合

---

## [TRADES] 交易分析

### 訓練集交易
- **總交易**: 61 筆
- **Buy Call**: 61 筆
- **Buy Put**: 0 筆

### 測試集交易
- **總交易**: 15 筆
- **Buy Call**: 15 筆
- **Buy Put**: 0 筆

---

## [GRADE] 策略評級

### 評級標準
- **A+ (>=0.9)**: 優秀, 可考慮實盤
- **A (>=0.8)**: 良好, 謹慎實盤
- **B (>=0.7)**: 中等, 需優化
- **C (>=0.6)**: 不佳, 需大幅改進
- **D (>=0.4)**: 差, 重新設計
- **F (<0.4)**: 失敗, 根本性問題

### 本次評級: **D**

**綜合評分**: 0.5982

### 建議
[X] 策略表現不佳:
1. 重新檢視策略邏輯
2. 增加更多特徵
3. 嘗試其他模型
4. 累積更多資料後重新訓練

---

## [!] 風險提示

1. **資料不足**: 目前僅 947 筆資料, 建議累積至 200+ 筆
2. **市場變化**: 歷史績效不代表未來表現
3. **選擇權風險**: 買方策略可能損失全部權利金
4. **模型限制**: 機器學習模型無法預測極端事件
5. **真實成本**: 報告已包含 Delta/Theta/滑價模擬, 實際成本可能更高

---

## [FILES] 輸出檔案

- `data/train/` - 訓練集資料
- `data/test/` - 測試集資料
- `models/direction_model.pkl` - XGBoost 模型
- `models/lgbm_model.pkl` - LightGBM 模型 (若有)
- `models/meta_learner.pkl` - Stacking Meta Learner (若有)
- `models/feature_cols.json` - 特徵欄位列表
- `results/optimization.json` - 最佳參數
- `results/backtest_train.csv` - 訓練集交易記錄
- `results/backtest_test.csv` - 測試集交易記錄
- `results/training_report.md` - 本報告

---

**報告結束**
